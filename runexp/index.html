<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://smarsgroup.github.io/geoepic-docs/runexp/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Running an Experiment - Geo-Epic</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Running an Experiment";
        var mkdocs_page_input_path = "runexp.md";
        var mkdocs_page_url = "/geoepic-docs/runexp/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Geo-Epic
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Intro</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../epic/">EPIC Model</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../csb/">Crop Sequence Boundaries</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Weather/">Weather Module</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Soil/">Soil Module</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../OPC/">Crop Management</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Running an Experiment</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#todo">&lt;ToDo62</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../opt/">Model Calibration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../api/">API</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Geo-Epic</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Running an Experiment</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/smarsGroup/geoepic-docs/edit/master/docs/runexp.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="running-the-model">Running the model</h1>
<h4 id="todo">&lt;ToDo&gt;</h4>
<pre><code class="language-python">from geoEpic import Site, EpicModel

# initialise a site object
site = Site(opc = './continuous_corn.OPC',  # management file
            dly = './1123455.DLY',          # daily weather file 
            sol = './Andisol.SOL',          # soil file
            sit = './1.SIT')                # site file


# initialise the EPIC model
model = EpicModel(path = './model/EPIC2301dt20230820')
model.setup(start_year = 2014, duration = 10)
model.set_output_types(['ACY', 'DGN'])

# run the simulation for the site
model.run(site)

# get the required outputs
acy = model.outputs['ACY']
model.close()
</code></pre>
<p>Loading from config files:</p>
<pre><code class="language-python">site = Site.from_config(lat = , lon = , config = './config.yml')
model = EpicModel.from_config(config = './config.yml')

model.run(site)
model.close()
</code></pre>
<p><strong>Example config file:</strong></p>
<pre><code class="language-yml"># Model details
EPICModel: ./model/EPIC2301dt20230820
start_year: 1995
duration: 25
output_types:
  - ACY  # Annual Crop data file
  - DGN  # Daily general output file
log_dir: ./log
output_dir: ./output

</code></pre>
<ul>
<li>To edit the OPC, SOL or files in the epic model folder, you could use the epic_editor. the following command will copy the epiceditor in to your current folder.</li>
</ul>
<pre><code class="language-bash">&gt;&gt; geo-epic workspace add epic_editor
</code></pre>
<h1 id="running-an-epic-experiment">Running an EPIC Experiment</h1>
<h3 id="1-create-new-workspace">1. Create new workspace</h3>
<pre><code class="language-bash">epic_pkg workspace new -w Test
cd Test
</code></pre>
<p>It willl create a new workspace in the new directory named 'Test'. This 'Test' folder will automatically create sub-folders for EPIC model like model, opc, sites, soil, weather and a config.yml doc in it. You need to to go to Test folder before simulation starts.</p>
<h3 id="2-edit-config-file-as-needed">2. Edit config file as needed</h3>
<p>This package is mainly designed for study regions in the USA. In the config.yml file, update the settings in the config file based on your area of interest (AOI) and preferences. For example, if you need to run the model for the state of Maryland, USA, modify these rows as follows:</p>
<pre><code>EXPName: Nitrogen Assessment (Your Experiment Name) 
Region: Maryland 
code: MD 
Fields_of_Interests: ./CropRotations/MDRotFilt.shp
</code></pre>
<p>Note: The MDRotFilt.shp file is the same one downloaded and placed in the CropRotations folder in the previous step.</p>
<pre><code>soil: 
   ssurgo_gdb: ./soil/gSSURGO_MD.gdb
</code></pre>
<p>Guideline: The rule of thumb is to edit the configuration file using the region code specific to your study region, as done here using "MD" throughout the config file.</p>
<h3 id="3-prepare-opc-file">3. Prepare OPC File</h3>
<p>OPC refers to the agricultural management practice files which is yet to automated. For now, you need to prpare management files and keep it in a new folder named 'OPC' inside the 'Test' directory.</p>
<h3 id="4-prepare-the-workspace">4. Prepare the workspace</h3>
<pre><code class="language-bash">epic_pkg workspace prepare
</code></pre>
<p>This command will automatically pre-process the input files before simulation.</p>
<h3 id="5-and-execute-the-simulations">5. And execute the simulations</h3>
<pre><code class="language-bash">epic_pkg workspace run
</code></pre>
<p>This command will simulate the operation/s and automatically save the results in a new folder named 'Output'. </p>
<p>This command will also create a <strong>post_process.pynb</strong> doc which will have an example code to visualize the required parameters from ACY and DGN files. </p>
<p>You can edit this code as per your requirements. You just have to identify the parameters and edit accordingly.</p>
<h2 id="example-visualization">Example Visualization</h2>
<h3 id="6-post-process-the-output-visualization">6. Post-process the output visualization</h3>
<p>You need to post-process the output files according to your interests. Generally, as an agricultural reserachers you need to process the DGN and ACY files.</p>
<h4 id="for-post-processing">For post-processing</h4>
<pre><code>epic_pkg workspace post_process
</code></pre>
<p>This will run the example code <strong>post_process.pynb</strong> which has been created in the Test folder. It will take a variable called 'YLDG' which denotes the yearly yield in t/ha/yr for all the sites and put it in a sepearte column corresponding to all the site ids with creatinh a yldg.csv file.</p>
<h4 id="for-visualization">For visualization</h4>
<pre><code>epic_pkg workspace visualize
</code></pre>
<p>It will simply plot the 'YLDG' variable corresponding to the site ids and crate a map for study region. </p>
<h3 id="your-plot-will-look-like-this">Your plot will look like this:</h3>
<p><img alt="'Maryland_Yield'" src="./Yield_MD.png" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../OPC/" class="btn btn-neutral float-left" title="Crop Management"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../opt/" class="btn btn-neutral float-right" title="Model Calibration">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/smarsGroup/geoepic-docs" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../OPC/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../opt/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
